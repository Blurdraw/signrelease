<html>
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1.0">
    <title>demo</title>
		<style>
			body{
				margin:0px;
			}
		</style>
  </head>
  <body>
		<canvas id="myCanvas" style="position:fixed;z-index:-1;">
			Your browser does not support the HTML5 canvas tag.
		</canvas>
		<h1>Canvas</h1>
		<script>
			var c=document.getElementById("myCanvas")
			var width
			var height
			var time
			var num=45     //默认PC端小球数
			var maxr=12		 //默认最大小球半径
			var smallnum=20//手机屏幕时小球数
			var smallr=8   //手机屏幕时最大小球半径
			var ballColor='0,0,0,'
			var lineColor='0,0,0,'
			var balls=Array()
			function Ball(x,y,r,dx,dy){
				this.x=x
				this.y=y
				this.r=r
				this.dx=dx
				this.dy=dy
			}
			Ball.prototype.render = function(cxt){
				cxt.fillStyle='rgba('+ballColor+'0.2)'
				cxt.beginPath()
				cxt.arc(this.x, this.y, this.r, 0, 2 * Math.PI,true)
				cxt.closePath()
				cxt.fill();
			}
			Ball.prototype.move = function(){
				this.x+=this.dx
				this.y+=this.dy
				if(this.x > width || this.x < 0)this.dx=-this.dx
				if(this.y > height || this.y < 0)this.dy=-this.dy
			}
			function drawLine(x, y,endx,endy,cxt) {
				var dX = Math.abs(x - endx)
				var	dY = Math.abs(y - endy)
				var lineLength = Math.sqrt(dX * dX + dY * dY)
				var formula = 1 / lineLength * 5 - 0.009
				var opacity = formula > 0.001 ? formula: 0.001
				if(width<400 || height<400){
					opacity-=0.015
				}
				cxt.beginPath()
				cxt.strokeStyle = 'rgba('+lineColor+opacity+')'
				cxt.moveTo(x,y)
				cxt.lineTo(endx,endy)
				cxt.closePath()
				cxt.stroke();
			}
			function init(){
				balls=[]
				width=document.body.clientWidth
				height=document.body.clientHeight
				c.setAttribute("width",width)
				c.setAttribute("height",height)
				var ctx=c.getContext("2d")
				//适配屏幕
				if(width < 400 || height<400){
					num=smallnum
					maxr=smallr
				}
				for(i=0;i<num;i++){
					var b=new Ball(parseInt(Math.random()*width*0.5),parseInt(Math.random()*height*0.5),parseInt(Math.random()*maxr),Math.random()*2-1,Math.random()*2-1)
					balls.push(b)
				}
				time=setInterval(function(){
					clear()
					frame(ctx);
				}, 20);
			}
			function frame(ctx){
				//绘制小球
				for(i=0;i<num;i++){
					balls[i].move()
					balls[i].render(ctx)
				}
				//绘制连线
				for(i=0;i<num-1;i++)
					for(j=i+1;j<num;j++){
						drawLine(balls[i].x,balls[i].y,balls[j].x,balls[j].y,ctx)
					}	
			}
			function clear(){//不知为何其它方法没有作用
				if(c.width != document.body.clientWidth || c.height != document.body.clientHeight){
					resize()
				}
				c.height=document.body.clientHeight;
				c.width=document.body.clientWidth;
			}
			init()

			 function resize(){
				clearInterval(time)
				init()
			}
		</script>
  </body>
</html>
